Refer to the `cuda` branch for the latest implementation.
